defmodule AdventOfCode2018.Day4_Test do
  use ExUnit.Case

  import AdventOfCode2018.Day4

  test "parse_input" do
    assert parse_input("""
           [1518-11-01 00:00] Guard #10 begins shift
           [1518-11-01 00:05] falls asleep
           [1518-11-01 00:25] wakes up
           [1518-11-01 00:30] falls asleep
           [1518-11-01 00:55] wakes up
           [1518-11-01 23:58] Guard #99 begins shift
           [1518-11-02 00:40] falls asleep
           [1518-11-02 00:50] wakes up
           [1518-11-03 00:05] Guard #10 begins shift
           [1518-11-03 00:24] falls asleep
           [1518-11-03 00:29] wakes up
           [1518-11-04 00:02] Guard #99 begins shift
           [1518-11-04 00:36] falls asleep
           [1518-11-04 00:46] wakes up
           [1518-11-05 00:03] Guard #99 begins shift
           [1518-11-05 00:45] falls asleep
           [1518-11-05 00:55] wakes up
           """) == [
             {1518, 11, 01, 00, 00, "10"},
             {1518, 11, 01, 00, 05, "asleep"},
             {1518, 11, 01, 00, 25, "up"},
             {1518, 11, 01, 00, 30, "asleep"},
             {1518, 11, 01, 00, 55, "up"},
             {1518, 11, 01, 23, 58, "99"},
             {1518, 11, 02, 00, 40, "asleep"},
             {1518, 11, 02, 00, 50, "up"},
             {1518, 11, 03, 00, 05, "10"},
             {1518, 11, 03, 00, 24, "asleep"},
             {1518, 11, 03, 00, 29, "up"},
             {1518, 11, 04, 00, 02, "99"},
             {1518, 11, 04, 00, 36, "asleep"},
             {1518, 11, 04, 00, 46, "up"},
             {1518, 11, 05, 00, 03, "99"},
             {1518, 11, 05, 00, 45, "asleep"},
             {1518, 11, 05, 00, 55, "up"}
           ]
  end

  test "build_guards_sleep_grid" do
    assert build_guards_sleep_grid([
             {1518, 11, 01, 00, 00, "10"},
             {1518, 11, 01, 00, 05, "asleep"},
             {1518, 11, 01, 00, 25, "up"},
             {1518, 11, 01, 00, 30, "asleep"},
             {1518, 11, 01, 00, 55, "up"},
             {1518, 11, 01, 23, 58, "99"},
             {1518, 11, 02, 00, 40, "asleep"},
             {1518, 11, 02, 00, 50, "up"},
             {1518, 11, 03, 00, 05, "10"},
             {1518, 11, 03, 00, 24, "asleep"},
             {1518, 11, 03, 00, 29, "up"},
             {1518, 11, 04, 00, 02, "99"},
             {1518, 11, 04, 00, 36, "asleep"},
             {1518, 11, 04, 00, 46, "up"},
             {1518, 11, 05, 00, 03, "99"},
             {1518, 11, 05, 00, 45, "asleep"},
             {1518, 11, 05, 00, 55, "up"}
           ]) == %{
             {1518, 11, 01, "10"} => [
               05,
               06,
               07,
               08,
               09,
               10,
               11,
               12,
               13,
               14,
               15,
               16,
               17,
               18,
               19,
               20,
               21,
               22,
               23,
               24,
               30,
               31,
               32,
               33,
               34,
               35,
               36,
               37,
               38,
               39,
               40,
               41,
               42,
               43,
               44,
               45,
               46,
               47,
               48,
               49,
               50,
               51,
               52,
               53,
               54
             ],
             {1518, 11, 02, "99"} => [40, 41, 42, 43, 44, 45, 46, 47, 48, 49],
             {1518, 11, 03, "10"} => [24, 25, 26, 27, 28],
             {1518, 11, 04, "99"} => [36, 37, 38, 39, 40, 41, 42, 43, 44, 45],
             {1518, 11, 05, "99"} => [45, 46, 47, 48, 49, 50, 51, 52, 53, 54]
           }
  end

  test "do_guard_most_asleep" do
    assert do_guard_most_asleep([
             {1518, 11, 01, 00, 00, "10"},
             {1518, 11, 01, 00, 05, "asleep"},
             {1518, 11, 01, 00, 25, "up"},
             {1518, 11, 01, 00, 30, "asleep"},
             {1518, 11, 01, 00, 55, "up"},
             {1518, 11, 01, 23, 58, "99"},
             {1518, 11, 02, 00, 40, "asleep"},
             {1518, 11, 02, 00, 50, "up"},
             {1518, 11, 03, 00, 05, "10"},
             {1518, 11, 03, 00, 24, "asleep"},
             {1518, 11, 03, 00, 29, "up"},
             {1518, 11, 04, 00, 02, "99"},
             {1518, 11, 04, 00, 36, "asleep"},
             {1518, 11, 04, 00, 46, "up"},
             {1518, 11, 05, 00, 03, "99"},
             {1518, 11, 05, 00, 45, "asleep"},
             {1518, 11, 05, 00, 55, "up"}
           ]) == 240
  end

  test "do_guard_most_asleep_on_same_minute" do
    assert do_guard_most_asleep_on_same_minute([
             {1518, 11, 01, 00, 00, "10"},
             {1518, 11, 01, 00, 05, "asleep"},
             {1518, 11, 01, 00, 25, "up"},
             {1518, 11, 01, 00, 30, "asleep"},
             {1518, 11, 01, 00, 55, "up"},
             {1518, 11, 01, 23, 58, "99"},
             {1518, 11, 02, 00, 40, "asleep"},
             {1518, 11, 02, 00, 50, "up"},
             {1518, 11, 03, 00, 05, "10"},
             {1518, 11, 03, 00, 24, "asleep"},
             {1518, 11, 03, 00, 29, "up"},
             {1518, 11, 04, 00, 02, "99"},
             {1518, 11, 04, 00, 36, "asleep"},
             {1518, 11, 04, 00, 46, "up"},
             {1518, 11, 05, 00, 03, "99"},
             {1518, 11, 05, 00, 45, "asleep"},
             {1518, 11, 05, 00, 55, "up"}
           ]) == 4455
  end
end
